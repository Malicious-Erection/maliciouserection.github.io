<html>
<head>
    <style>
    code {
    font-family: Consolas,"courier new";
    color: black;
    background-color: #f1f1f1;
    padding: 2px;
    font-size: 105%;
}
</style>
    <script>
        window.onerror = function(msg, url, linenumber) {
            var yaymessageyay = 'Error message: ' + msg + '\n\nLine number: ' + linenumber;
            document.getElementById("javaErrors").innerHTML = yaymessageyay;
            return true;
        }
    </script>
</head>
<body>

<h3>Example - Exfiltrate files via WebView File Access</h3>
<h2>This site is used with the Pentesting Exploits Noted In Smartphones training course.</h2>
This webpage has an interactive JavaScript window.
<br>
<br>
Type your JavaScript into the text box below, and tap <code>eval</code>.
<br>
<br>
This will execute your input as JavaScript.
<br>
<br>
Note that <code>alert()</code> does not work in this WebView because this WebView does not use <code>setWebChromeClient()</code>.
<br>
<br>
Analyze this activity and learn about abusing WebView File Access to exfiltrate files.
<br>
<br>
<p id="fileAccessCheck"></p>
<script>
    var fileCheckResult = window.yayjsinterfaceyay.checkFileAccess();
    document.getElementById("fileAccessCheck").innerHTML = fileCheckResult;
</script>
<textarea rows="10" cols="40" type=text id="evalInput"></textarea><br><button id="evalButton">eval</button>
<script>
var yayEvalButtonYay = document.querySelector("#evalButton");
var yayEvalInputYay = document.querySelector("#evalInput");
yayEvalButtonYay.addEventListener('click', function() {
    eval(yayEvalInputYay.value);
});
</script>
<br>
<br>
If you see the image below, then the image <code>_axolotl_phone.jpg</code> was loaded via a <code>file://</code> scheme.
<img src="file:////sdcard/Android/data/com.maliciouserection.axolotl/files/_axolotl_phone.jpg" width="369">